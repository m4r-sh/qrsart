class j{constructor(_=64,h=[],X=[]){if(_<1)throw new Error("Capacity must be positive");if(this._capacity=_,this._objects=new Array(_+1),this._priorities=new Float64Array(_+1),this.length=h.length,h.length!==X.length)throw new Error("Objects/priorities mismatch");if(_<h.length)throw new Error("Capacity too small");for(let O=0;O<h.length;O++)this._objects[O+1]=h[O],this._priorities[O+1]=X[O];for(let O=h.length>>>1;O>=1;O--)this.#h(O)}get capacity(){return this._capacity}clear(){this.length=0}size(){return this.length}#_(_){let h=this._objects[_],X=this._priorities[_];while(_>1){let O=_>>>1;if(this._priorities[O]<=X)break;this._objects[_]=this._objects[O],this._priorities[_]=this._priorities[O],_=O}this._objects[_]=h,this._priorities[_]=X}#h(_){let h=this._objects[_],X=this._priorities[_],O=1+(this.length>>>1),R=this.length+1-1;while(_<O){let T=_<<1,E=this._priorities[T],I=this._objects[T],N=T,D=T+1;if(D<=R&&this._priorities[D]<E)E=this._priorities[D],I=this._objects[D],N=D;if(E>=X)break;this._objects[_]=I,this._priorities[_]=E,_=N}this._objects[_]=h,this._priorities[_]=X}push(_,h){if(this.length===this._capacity)throw new Error("Heap full");let X=this.length+1;this._objects[X]=_,this._priorities[X]=h,this.length++,this.#_(X)}pop(){if(!this.length)return;let _=this._objects[1];if(this._objects[1]=this._objects[this.length+1-1],this._priorities[1]=this._priorities[this.length+1-1],this.length--,this.length>0)this.#h(1);return _}peekPriority(){return this._priorities[1]}peek(){return this._objects[1]}consider(_,h){if(this.length<this._capacity)this.push(h,_);else if(_>this._priorities[1])this._objects[1]=h,this._priorities[1]=_,this.#h(1)}extractAll(){let _=[];while(this.length>0){let h=this._priorities[1],X=this.pop();_.unshift({score:h,object:X})}return _}}var Q={case(_="",{enableCaps:h=!1}={}){if(!h)return{total:1,get:(O)=>_};let X=[];for(let O=0;O<_.length;O++)if(_[O].toLowerCase()!==_[O].toUpperCase())X.push(O);return{total:2**X.length,get:(O)=>{let R=_.split("");for(let T=0;T<X.length;T++){let E=X[T];R[E]=O>>T&1?_[E].toUpperCase():_[E].toLowerCase()}return R.join("")}}},group(_=[],{join:h=""}={}){let X=_.map((O)=>typeof O.total==="number"?O.total:1);return{total:X.reduce((O,R)=>O*R,1),get:(O)=>{let R=O,T=[];for(let E=_.length-1;E>=0;E--){let I=X[E],N=R%I;R=Math.floor(R/I),T.unshift(typeof _[E]==="string"?_[E]:_[E].get(N))}return T.join(h)}}},url(_="",{protocolCaps:h=!1,domainCaps:X=!1,pathCaps:O=!1}={}){let R=new URL(_.startsWith("https")?_:`https://${_}`),T=Q.case(R.protocol,{enableCaps:h}),E=Q.case(R.hostname,{enableCaps:X}),I=Q.case(R.pathname||"/",{enableCaps:O}),N=Q.group([T,"//",E,I]);return{total:N.total,get:(D)=>N.get(D)+(R.search||"")+(R.hash||"")}},phone(_="0123456789",{forceCountry:h=!1,validSpacers:X=[""],prefixCaps:O=!1}={}){},email(_="someone@example.com",{perfixCaps:h=!1,domainCaps:X=!1}={}){},emailMessage(_="",{prefixCaps:h=!1,domainCaps:X=!1,queryCaps:O=!1,queryOrdering:R=!0}={}){},sms(_="0123456789",{forceCountry:h=!1,validSpacers:X=[""],prefixCaps:O=!1,queryCaps:R=!1}={}){},wifi({name:_="",pwd:h=""}){let X=["T:WPA","S:"+_,"P:"+h],O=[[0,1,2],[0,2,1],[1,0,2],[1,2,0],[2,1,0],[2,0,1]];return{total:O.length,get:(R)=>`WIFI:${O[R].map((T)=>X[T]).join(";")};;`}},vcard({name:_="",phone:h="",email:X=""},{}={}){},event({summary:_,dtstart:h},{}={}){},geo({latitude:_="",longitude:h=""}={},{}={}){},bitcoin({address:_,amount:h},{prefixCaps:X=!0,queryCaps:O=!0,queryOrder:R=!0}={}){},ethereum({address:_,amount:h},{prefixCaps:X=!0,queryCaps:O=!0,queryOrder:R=!0}={}){}};var F=[{formatBits:1,codewords_per_block:[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],num_ecc_blocks:[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25]},{formatBits:0,codewords_per_block:[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],num_ecc_blocks:[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49]},{formatBits:3,codewords_per_block:[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],num_ecc_blocks:[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68]},{formatBits:2,codewords_per_block:[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30],num_ecc_blocks:[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]}];var M=[(_,h)=>(_+h)%2==0,(_,h)=>h%2==0,(_,h)=>_%3==0,(_,h)=>(_+h)%3==0,(_,h)=>(Math.floor(_/3)+Math.floor(h/2))%2==0,(_,h)=>_*h%2+_*h%3==0,(_,h)=>(_*h%2+_*h%3)%2==0,(_,h)=>((_+h)%2+_*h%3)%2==0];class J{constructor(_,h){this.w=_,this.h=h,this.data=new Uint8Array(Math.ceil(_*h/4))}#_(_,h){let X=h*this.w+_;return[X>>2,(X&3)<<1]}set(_=0,h=0,X=1){if(_<0||_>=this.w||h<0||h>=this.h)return;let[O,R]=this.#_(_,h),T=3<<R,E=(X&1)<<R|1<<R+1;this.data[O]=this.data[O]&~T|E}get(_=0,h=0){if(_<0||_>=this.w||h<0||h>=this.h)return 0;let[X,O]=this.#_(_,h);return this.data[X]>>O&1}used(_=0,h=0){if(_<0||_>=this.w||h<0||h>=this.h)return 0;let[X,O]=this.#_(_,h);return this.data[X]>>O+1&1}*tiles(_=null){let{w:h,h:X,data:O}=this,R=h*X;for(let T=0;T<O.length;T++){let E=O[T];if(E===0)continue;let I=T<<2;for(let N=0;N<4;N++){let D=I+N;if(D>=R)break;let W=N<<1;if(!(E&2<<W))continue;let Z=E&1<<W;if(_===!0&&!Z)continue;if(_===!1&&Z)continue;yield[D%h,Math.floor(D/h)]}}}static union(..._){let h=Math.max(..._.map((R)=>R.w)),X=Math.max(..._.map((R)=>R.h)),O=new J(h,X);for(let R of _)for(let[T,E]of R.tiles())if(!O.get(T,E))O.set(T,E,R.get(T,E));return O}static erase(_,...h){let X=new J(_.w,_.h);for(let[O,R]of _.tiles())if(!h.some((T)=>T.used(O,R)))X.set(O,R,_.get(O,R));return X}static intersect(_,...h){let X=new J(_.w,_.h);for(let[O,R]of _.tiles())if(h.every((T)=>T.used(O,R)))X.set(O,R,_.get(O,R));return X}}class f{constructor({version:_=2,ecl:h=0,mask:X=0,bitstring:O=new Uint8Array}={}){this.version=_,this.ecl=h,this.mask=X,this.bitstring=O}get size(){return this.version*4+17}get functional_grid(){let{finder_grid:_,timing_grid:h,alignment_grid:X,version_grid:O,format_grid:R}=this;return J.union(_,h,X,O,R)}get finder_grid(){let{size:_}=this,h=new J(_,_);for(let X=0;X<8;X++)for(let O=0;O<8;O++){let R=Math.max(Math.abs(3-X),Math.abs(3-O))!=2&&!(X==7||O==7);h.set(X,O,R),h.set(_-X-1,O,R),h.set(X,_-O-1,R)}return h}get timing_grid(){let{size:_}=this,h=new J(_,_);for(let X=8;X<=_-8;X++){let O=X%2==0;h.set(6,X,O),h.set(X,6,O)}return h}get alignment_positions(){let{version:_,size:h}=this;if(_==1)return[];let X=Math.floor(_/7)+2,O=_==32?26:Math.ceil((_*4+4)/(X*2-2))*2,R=[6];for(let T=h-7;R.length<X;T-=O)R.splice(1,0,T);return R}get alignment_grid(){let{version:_,size:h,alignment_positions:X}=this,O=new J(h,h),R=X.length;for(let T=0;T<R;T++)for(let E=0;E<R;E++)if(!(T==0&&E==0||T==0&&E==R-1||T==R-1&&E==0))for(let I=-2;I<=2;I++)for(let N=-2;N<=2;N++){let D=Math.max(Math.abs(N),Math.abs(I))==1?0:1;O.set(X[T]+N,X[E]+I,D)}return O}get format_grid(){let{ecl:_,mask:h,size:X}=this,O=new J(X,X),R=F[_].formatBits<<3|h,T=R;for(let I=0;I<10;I++)T=T<<1^(T>>>9)*1335;let E=(R<<10|T)^21522;for(let I=0;I<=5;I++)O.set(8,I,E>>I);O.set(8,7,E>>6),O.set(8,8,E>>7),O.set(7,8,E>>8);for(let I=9;I<15;I++)O.set(14-I,8,E>>I);for(let I=0;I<8;I++)O.set(this.size-1-I,8,E>>I);for(let I=8;I<15;I++)O.set(8,this.size-15+I,E>>I);return O.set(8,this.size-8,1),O}get version_grid(){let{version:_,size:h}=this,X=new J(h,h);if(_<7)return X;let O=_;for(let T=0;T<12;T++)O=O<<1^(O>>>11)*7973;let R=_<<12|O;for(let T=0;T<18;T++){let E=h-11+T%3,I=Math.floor(T/3);X.set(E,I,R>>T),X.set(I,E,R>>T)}return X}get data_grid(){let{size:_,functional_grid:h,bitstring:X,mask:O}=this,R=new J(_,_),T=0;for(let E=_-1;E>=1;E-=2){if(E===6)E=5;for(let I=0;I<_;I++)for(let N=0;N<2;N++){let D=E-N,Y=(E+1&2)===0?_-1-I:I;if(!h.used(D,Y)){let U=0;if(T<X.length*8){let V=Math.floor(T/8),P=7-T%8;U=X[V]>>P&1}U^=M[O](D,Y),R.set(D,Y,U),T++}}}return R}get grid(){let{functional_grid:_,data_grid:h}=this;return J.union(_,h)}static save(_){let{version:h,ecl:X,mask:O,bitstring:R}=_;return new Uint8Array([h&255,(X&3)<<3|(O&7)<<5,...R])}static load(_){return new f({version:_[0],ecl:_[1]>>3&3,mask:_[1]>>5&7,bitstring:_.slice(2)})}}var C=/^[0-9]*$/,b=/^[A-Z0-9 $%*+.\/:-]*$/;var y=new TextEncoder,A={numeric:{modeBits:1,charCost:(_)=>C.test(_)?3.3333333333333335:1/0,numCharCountBits:(_)=>[10,12,14][Math.floor((_+7)/17)],write(_){let h=[];for(let X=0;X<_.length;){let O=Math.min(_.length-X,3);K(parseInt(_.substr(X,O),10),O*3+1,h),X+=O}return h.slice()}},alpha:{modeBits:2,charCost:(_)=>b.test(_)?5.5:1/0,numCharCountBits:(_)=>[9,11,13][Math.floor((_+7)/17)],write(_){let h=[],X;for(X=0;X+2<=_.length;X+=2){let O="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:".indexOf(_.charAt(X))*45;O+="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:".indexOf(_.charAt(X+1)),K(O,11,h)}if(X<_.length)K("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:".indexOf(_.charAt(X)),6,h);return h.slice()}},byte:{modeBits:4,charCost:(_)=>x(_)*8,numCharCountBits:(_)=>[8,16,16][Math.floor((_+7)/17)],test:(_)=>!0,write(_){let h=y.encode(_),X=[];for(let O of h)K(O,8,X);return X.slice()}}};function K(_,h,X){if(h<0||h>31||_>>>h!=0)throw new RangeError("Value out of range");for(let O=h-1;O>=0;O--)X.push(_>>>O&1)}function x(_){let h=_.codePointAt(0);if(h<0)throw"invalid";else if(h<128)return 1;else if(h<2048)return 2;else if(h<65536)return 3;else if(h<1114112)return 4;else throw"invalid"}function G(_){if(_<1||_>255)throw new RangeError("Degree out of range");let h=[];for(let O=0;O<_-1;O++)h.push(0);h.push(1);let X=1;for(let O=0;O<_;O++){for(let R=0;R<h.length;R++)if(h[R]=L(h[R],X),R+1<h.length)h[R]^=h[R+1];X=L(X,2)}return h}function w(_,h){let X=h.map((O)=>0);for(let O of _){let R=O^X.shift();X.push(0),h.forEach((T,E)=>X[E]^=L(T,R))}return X}function L(_,h){if(_>>>8!=0||h>>>8!=0)throw new RangeError("Byte out of range");let X=0;for(let O=7;O>=0;O--)X=X<<1^(X>>>7)*285,X^=(h>>>O&1)*_;return X}function k(_,h,X){let O=B(h,X)*8,R=_.length,T=[{cost:0,steps:[],mode:""}];for(let E=0;E<R;E++){let I=[];for(let N of T)for(let D of["numeric","alpha","byte"]){let W=A[D].charCost(_[E]);if(W===1/0)continue;let Y=N.mode===D?0:4+A[D].numCharCountBits(h),Z=N.cost+Y+W;if(Z>O)continue;I.push({cost:Z,steps:[...N.steps,D],mode:D})}T=I}return T.map(({steps:E,cost:I})=>({steps:E,cost:I,bitstring:u(_,E,h,X)}))}function u(_,h,X,O){let R=c(_,h),T=[];for(let{mode:H,str:$}of R){K(A[H].modeBits,4,T),K($.length,A[H].numCharCountBits(X),T);for(let q of A[H].write($))T.push(q)}let E=B(X,O)*8;K(0,Math.min(4,E-T.length),T),K(0,(8-T.length%8)%8,T);for(let H=236;T.length<E;H^=253)K(H,8,T);let I=[];while(I.length*8<T.length)I.push(0);T.forEach((H,$)=>I[$>>>3]|=H<<7-($&7));let N=F[O].num_ecc_blocks[X],D=F[O].codewords_per_block[X],W=Math.floor(z(X)/8),Y=N-W%N,Z=Math.floor(W/N),U=[],V=G(D);for(let H=0,$=0;H<N;H++){let q=I.slice($,$+Z-D+(H<Y?0:1));$+=q.length;let S=w(q,V);if(H<Y)q.push(0);U.push(q.concat(S))}let P=[];for(let H=0;H<U[0].length;H++)U.forEach(($,q)=>{if(H!=Z-D||q>=Y)P.push($[H])});return new Uint8Array(P)}function z(_){let h=(16*_+128)*_+64;if(_>=2){let X=Math.floor(_/7)+2;h-=(25*X-10)*X-55,h-=_>=7?36:0}return h}function B(_,h){return Math.floor(z(_)/8)-F[h].codewords_per_block[_]*F[h].num_ecc_blocks[_]}function c(_="",h=[]){let X=[],O=h[0],R=0;for(let T=1;T<=_.length;T++)if(T>=_.length||h[T]!=O)X.push({mode:O,str:_.slice(R,T)}),O=h[T],R=T;return X}function R2(_,h,{capacity:X=20,ecl:O=0,version:R=2}={}){let T=new j(X),E=[];for(let I of _)for(let{bitstring:N}of k(I,R,O))for(let D=0;D<8;D++){let W={version:R,ecl:O,mask:D,bitstring:N},Y=new f(W),{score:Z,obj:U}=h(Y);T.consider(Z,{obj:U,qr_params:W})}return T.extractAll()}function E2(_="url",h="https://qrs.art",X={}){return Q[_](h,X)}function I2({permutation:_={},start:h=0,stride:X=1,limit:O=1000,loop:R=20000}){let{total:T,get:E}=_,I=[];for(let N=0;N<O;N++){let D=(h+N*X)%R;if(D>=T)continue;I.push(E(D))}return I}export{R2 as search,E2 as permute,I2 as batch};
